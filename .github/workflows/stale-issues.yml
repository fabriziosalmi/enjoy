# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ðŸ§¹ STALE ISSUES - Auto-close inactive issues to keep the board clean
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Philosophy: If an issue sits untouched, it's probably not urgent.
# If the problem persists, it will resurface naturally.
# A clean board = focused energy = better game.
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

name: ðŸ§¹ Stale Issues Cleanup

on:
  schedule:
    # Run daily at 3:00 AM UTC
    - cron: '0 3 * * *'
  workflow_dispatch:
    inputs:
      dry_run:
        description: 'Dry run (no actual changes)'
        required: false
        default: 'false'
        type: boolean

permissions:
  issues: write
  pull-requests: write

jobs:
  stale:
    runs-on: [self-hosted, enjoy-trusted]
    steps:
      - name: ðŸ§¹ Mark and close stale issues
        uses: actions/stale@v9
        with:
          # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          # TIMING
          # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          # Days before marking as stale
          days-before-stale: 30
          # Days after stale label before closing
          days-before-close: 14
          # Don't auto-close PRs (they have different dynamics)
          days-before-pr-close: -1
          
          # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          # LABELS
          # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          stale-issue-label: 'ðŸ’¤ stale'
          stale-pr-label: 'ðŸ’¤ stale'
          close-issue-label: 'ðŸšª auto-closed'
          
          # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          # EXEMPT LABELS - Never mark these as stale
          # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          exempt-issue-labels: |
            ðŸ“Œ pinned
            ðŸ”’ security
            ðŸŽ¯ help wanted
            ðŸ’° bounty
            ðŸš€ in-progress
            â­ good first issue
            ðŸ› confirmed bug
            ðŸ“‹ roadmap
          exempt-pr-labels: |
            ðŸ“Œ pinned
            ðŸ”’ security
            ðŸš€ in-progress
          
          # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          # MESSAGES - Friendly, game-themed
          # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          stale-issue-message: |
            ## ðŸ’¤ This issue is getting sleepy...
            
            This issue hasn't had any activity in **30 days**. 
            
            To keep our board focused and energetic, it will be **automatically closed in 14 days** if there's no further activity.
            
            ### ðŸŽ® What you can do:
            - **Comment** if this is still relevant (any comment removes the stale label)
            - **Close it** if it's no longer needed
            - **Submit a PR** to fix it and earn karma! âœ¨
            
            > *"A clean board is a happy board"* â€” The Enjoy Philosophy
            
            ---
            *This is an automated message. The issue will reopen automatically if the problem resurfaces.*
          
          stale-pr-message: |
            ## ðŸ’¤ This PR needs attention...
            
            This pull request hasn't had activity in **30 days**.
            
            ### ðŸŽ® What's next?
            - **Update** your PR if changes are needed
            - **Comment** if you're still working on it
            - **Close** if you've moved on (no worries, it happens!)
            
            PRs are not auto-closed, but please update us on the status.
          
          close-issue-message: |
            ## ðŸšª Auto-closed due to inactivity
            
            This issue was automatically closed after **44 days** without activity (30 days stale + 14 days warning).
            
            ### ðŸ”„ Not resolved?
            If this issue is still relevant:
            1. **Reopen** this issue with a comment explaining the current status
            2. Or **create a new issue** with updated information
            
            Thank you for helping keep our board clean! ðŸ§¹âœ¨
            
            ---
            *Remember: Solving issues earns karma! Check [PLAY.md](../PLAY.md) for details.*
          
          # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          # BEHAVIOR
          # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          # Remove stale label when updated
          remove-stale-when-updated: true
          # Only process issues with these labels (empty = all)
          only-labels: ''
          # Process this many issues per run (avoid rate limits)
          operations-per-run: 100
          # Ascending = oldest first
          ascending: true
          # Don't stale issues with assignees (someone's working on it)
          exempt-all-assignees: true
          # Include issues created by bots? No.
          exempt-issue-creators: |
            github-actions[bot]
            dependabot[bot]
            renovate[bot]
          
          # Debug mode
          debug-only: ${{ github.event.inputs.dry_run == 'true' }}

      - name: ðŸ“Š Summary
        run: |
          echo "## ðŸ§¹ Stale Issues Cleanup Complete" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "| Setting | Value |" >> $GITHUB_STEP_SUMMARY
          echo "|---------|-------|" >> $GITHUB_STEP_SUMMARY
          echo "| Days before stale | 30 |" >> $GITHUB_STEP_SUMMARY
          echo "| Days before close | 14 (after stale) |" >> $GITHUB_STEP_SUMMARY
          echo "| Total lifecycle | 44 days |" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### ðŸ›¡ï¸ Exempt labels" >> $GITHUB_STEP_SUMMARY
          echo "- ðŸ“Œ pinned" >> $GITHUB_STEP_SUMMARY
          echo "- ðŸ”’ security" >> $GITHUB_STEP_SUMMARY
          echo "- ðŸŽ¯ help wanted" >> $GITHUB_STEP_SUMMARY
          echo "- ðŸ’° bounty" >> $GITHUB_STEP_SUMMARY
          echo "- ðŸš€ in-progress" >> $GITHUB_STEP_SUMMARY
          echo "- â­ good first issue" >> $GITHUB_STEP_SUMMARY
          echo "- ðŸ› confirmed bug" >> $GITHUB_STEP_SUMMARY
          echo "- ðŸ“‹ roadmap" >> $GITHUB_STEP_SUMMARY
